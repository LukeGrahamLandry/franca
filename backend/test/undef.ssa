# https://lists.sr.ht/~mpu/qbe/%3C3BM57P0KYZ41N.33ET0S1FSPNYI@mforney.org%3E
# :ThisShouldBeValidUndef

export function w $main() {
 @0
    %x =l alloc8 4
 @5
    %r =w call $f
    jnz %r, @6, @7
 @6
    %c =w loadw %x
    %c =w cnew %c, 1
    ret %c
 @7
    storew 1, %x
    jmp @5
}

data $c = { z 4 }
function w $f() {
 @1
    %c =w load $c
    jnz %c, @2, @4
 @2
    ret 1
 @4
    storew 1, $c
    ret 0
}
