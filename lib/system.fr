
fun panic(msg: Str) Never = {
    println(msg);
    exit(1)
}

fun println(var msg: Str) Unit = {
    const STD_OUT: Fd = 1;
    let ptr: Ptr(u8) = msg&.(0)[];
    let len: usize = msg&.(1)[];
    // TODO: this will try to write a bunch of zeros because i dont have bytes as a data type yet. 
    let written: isize = write(STD_OUT, ptr, len.mul(8));
    // TODO: check errno. loop if not all written. 
    
    // TODO: extra syscall is sad
    var ln = 10;
    let ptr: Ptr(u8) = ln&;
    let written: isize = write(STD_OUT, ptr, 1); 
}

fun args() Slice$CStr = {
    argc := _NSGetArgc()[];
    argv := _NSGetArgv()[];
    // Safety: the os wouldn't lie to us... hopefully.
    slice(@as(*CStr) argv, argc)
}
