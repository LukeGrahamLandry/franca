// The code in this file was written by chat gpt. 
// https://chat.openai.com/share/820af185-e2e0-4265-b743-22ba4ecff0cf
// I gave it Array and bloat.txt and size.py to compare and then explained syntax mistakes until it worked. 
// It doesn't seem great at remembering the odd syntax. 

@script

// I added this cause i dont want to deal with it
let Allocator = DefaultAllocator();

/////////////////
/// Fizz Buzz ///
/////////////////

fn fizzbuzz(n: i64) -> String {
    if(eq(mod(n, 3), 0), fn = {
        if(eq(mod(n, 5), 0), fn = {
            "FizzBuzz"
        }, fn = {
            "Fizz"
        })
    }, fn = {
        if(eq(mod(n, 5), 0), fn = {
            "Buzz"
        }, fn = {
            n
        })
    })
}

foreach(range(1, 101), fn(n) = print(fizzbuzz(n)));


//////////////////
/// Quick Sort ///
//////////////////

fn swap(arr: &Array(i64, Allocator), i: i64, j: i64) = {
    let temp = get(arr, i);
    set(arr, i, get(arr, j));
    set(arr, j, temp);
}

fn partition(arr: &Array(i64, Allocator), low: i64, high: i64) -> i64 {
    let pivot = get(arr, high);
    let mut i = sub(low, 1);

    for j = low; lt(j, high); j = add(j, 1) {
        if lt(get(arr, j), pivot) {
            i = add(i, 1);
            swap(arr, i, j);
        }
    }

    swap(arr, add(i, 1), high);
    add(i, 1)
}

fn quicksort(arr: &Array(i64, Allocator), low: i64, high: i64) = {
    if lt(low, high) {
        let pivotIndex = partition(arr, low, high);
        quicksort(arr, low, sub(pivotIndex, 1));
        quicksort(arr, add(pivotIndex, 1), high);
    }
}

fn sort(arr: &Array(i64, Allocator)) = {
    quicksort(arr, 0, sub(len(arr), 1));
}

// Example usage
var arr = array(i64, Allocator);
push(@addr(arr), 5);
push(@addr(arr), 2);
push(@addr(arr), 7);
push(@addr(arr), 3);
push(@addr(arr), 9);

println("Original array:");
enumerate(arr, fn(_, elem) = {
    print(get(elem));
});

sort(@addr(arr));

println("\nSorted array:");
enumerate(arr, fn(_, elem) = {
    print(get(elem));
});
