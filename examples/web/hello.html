<script type="module">
// THIS IS UNFINISHED
// TODO: the env imports call postMessage 
import * as FrancaGraphics from "../../graphics/web/app.js";
import { imports, handleWasmLoaded } from "./worker.js";
import { webgpu_wasm_exports, init_gpu } from "../../graphics/web/gfx.js";
let canvas = document.createElement("canvas");
canvas.width = 500;
canvas.height = 500;
canvas.style = "border:1px solid #000000;";
canvas.tabIndex = "1";  // this makes it focusable so it gets key events.
document.body.appendChild(canvas);
let w = await WebAssembly.instantiateStreaming(fetch("target/hello.wasm"), { 
    FrancaGraphics: FrancaGraphics, 
    webgpu: webgpu_wasm_exports,
    env: imports.env,
});
await init_gpu(w, canvas);
handleWasmLoaded(w, []);
</script>
