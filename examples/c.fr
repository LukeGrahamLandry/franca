main :: fn() void = ::go();

XX :: getmycode();
go :: fn() #use(XX) = {
    x := bar(1);
    @println("%", x);
}

C :: import("@/examples/import_c/lib.fr");
#include_std("backend/lib.fr");

// GARBAGE: for now all the import_c stuff is very experimental. the api will eventually get less painful. 
fn getmycode() ScopeId = {
    Ffi :: import("@/examples/import_c/ffi.fr");
    namespace := scope_of(Type, @struct(___HACK :: 123));
    fr := current_compiler_context();
    c_source := @tfmt("""
        int puts(char*);
        int foo(int a) {
            return a * 2;
        }
        int bar(int a) {
            puts("Hello World");
            return foo(a);
        }
    """);
    Ffi'import_c(fr, namespace, c_source);
    println("done exporting c");
    namespace
}