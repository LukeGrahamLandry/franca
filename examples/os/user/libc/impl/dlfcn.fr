// TODO: rest of the fucking owl

dlopen :: fn(name: CStr, _: i64) rawptr = {
    @trace("dlopen(%)", name);
    if name == "libc.so.6" || name == "/usr/lib/libc.dylib" {
        return(123.rawptr_from_int());
    };
    zeroed(rawptr)
};

dlsym :: fn(lib: rawptr, name: CStr) rawptr = {
    @assert_eq(lib.int_from_rawptr(), 123);
    dest := zeroed(rawptr);
    temporary_libc_import(name.str(), dest&, true);
    @trace("dlsym(%, %) = %", lib, name, dest);
    dest
};

dlclose :: fn() = 0;
