// THIS IS UNFINISHED
// TODO: replace webgpu.fr with this

dawn_json :: {
    b64 := fetch_text_or_crash(
        "https://dawn.googlesource.com/dawn/+/dfe3855e5d0b5367a598e60674766ffa1c894c71/src/dawn/dawn.json?format=TEXT",
        237144, "6cf95730c0cab2b19256d0a58b40fc1f2af8ab1bfb460bc7cd00707f01e6c1ac", temp(),
    );
    out := u8.list(ast_alloc());
    base64_decode(out&, b64);
    // lets just make sure my decoding isn't broken
    @assert_eq(Sha256'hex(out.items()), "bdf681b2c963d39f839b6590a25a739fa3a64f68ac9e0e8c0dc6d85f48c087ec");
    out.items()
}

main :: fn() void = {
    json: JsonParser = new_json(dawn_json, temp());
    
    loop {
        it := or json&.next() { e |
            panic(e)
        };
    }
}

#use("@/lib/encoding/json.fr");
#use("@/lib/encoding/base64.fr");
::import("@/examples/testing.fr");
